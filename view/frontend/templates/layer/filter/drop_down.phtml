<?php
/**
 *
 * @var $block \GoMage\Navigation\Block\Navigation\FilterRenderer
 */

$filter = reset($filterItems)->getFilter();
$categoriesHelper = $this->helper('GoMage\Navigation\Helper\CategoryData');
$helperData = $this->helper('GoMage\Navigation\Helper\Data');
?>

<div class="gan-filter gan-filter-dropdown">
    <select data-role="navigation-filter"
            data-param="<?= $block->escapeHtml($filter->getRequestVar()) ?>"
            data-type="select"
            <?php if  ($filter->getGomageIsAjax() || is_null($filter->getGomageIsAjax())):?>
                data-ajax="1"
            <?php else:?>
                data-ajax="0"
            <?php endif;?>
            <?php if (!empty($filter->getUsedOptions())): ?>
                data-active="1"
            <?php endif; ?>
    >
        <option value=""><?= __('Select Filter') ?></option>
        <?php $optionsLimit = ($filter->getGomageVisibleOptions()) ? $filter->getGomageVisibleOptions() : false;
        $cnt = 0;
        ?>
        <?php foreach ($filterItems as $item): ?>
            <?php if ($item->getCount() > 0 || ($helperData->isShowEmptyCategory() && $filter->isCategoryFilter())): ?>
                <option <?php if((!$item->isShowAppliedValues())): ?>style="display: none"<?php endif; ?> value="<?= $block->escapeHtml($item->getGomageValue()) ?>"
                        data-param="<?= $block->escapeHtml($filter->getRequestVar()) ?>"
                        <?php if ($item->getIsActive()): ?>selected="selected" data-active="1"<?php endif ?>>
                    <?= $block->escapeHtml($item->getLabel() . ' (' . $item->getCount() . ')', ['span']) ?>
                </option>
            <?php endif; ?>
            <?php $cnt++;?>
        <?php endforeach ?>
    </select>
    <?php if ($filter->isActive() && $filter->getGomageIsReset() || ($filter->isActive() &&$filter->isCategoryFilter() && $categoriesHelper->isShowResetLink() )):?>
        <a
                data-role="navigation-filter"
                data-value=""
                data-url="<?= $block->escapeUrl($filter->getRemoveUrl()) ?>"
                data-param-to-remove="<?=$block->escapeHtml($filter->getRequestVar()) ?>"
            <?php if  ($filter->getGomageIsAjax() || is_null($filter->getGomageIsAjax()) && ( ($filter->isCategoryFilter() &&  $categoriesHelper->isAjax()) ||  !$filter->isCategoryFilter()) ):?>
                data-ajax="1"
            <?php else:?>
                data-ajax="0"
            <?php endif;?>
                data-type="remove-item"
                data-active="1"
                href="#"
                class="gan_link_reset">
            <?= __('Reset'); ?>
        </a>
    <?php endif;?>
</div>
